<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Karma</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
      margin: 0;
      background: black no-repeat center center/cover;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      font-family: serif;
      color: white;
      text-align: center;
      cursor: pointer;
  }

  #text {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: clamp(24px, 5vw, 48px);
      opacity: 0;
      transition: opacity 0.3s ease;
      color: red;
      text-shadow: 0 0 10px black;
  }

  #blackFade {
      position: fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:black;
      opacity:1;
      transition: opacity 1s ease;
      z-index: 998;
  }

  #blackFade.cut {
    transition: none; /* remove fade transition */
    opacity: 1;       /* fully black immediately */
}
</style>
</head>
<body>

<div id="text"></div>
<div id="blackFade"></div>

<!-- Audio files -->
<audio id="whistleSound">
    <source src="heavybreath.wav" type="audio/mpeg">
</audio>
<audio id="gasmaskSound">
    <source src="BANG.wav" type="audio/mpeg">
</audio>

<script>
const textEl = document.getElementById('text');
const blackFade = document.getElementById('blackFade');
const whistle = document.getElementById('whistleSound');
const gasmaskSound = document.getElementById('gasmaskSound');

let clicked = false;
let flashInterval;

// ---------- START PAGE ----------
document.body.addEventListener('click', startPage, {once:true});

function startPage() {
    // Fade in from black
    blackFade.style.opacity = 0;

    // Show foreshadowing text
    setTimeout(()=>{
        textEl.textContent = "Those are not yours Krauts.";
        textEl.style.opacity = 1;

        // Play whistling sound
        whistle.play().catch(e=>console.log(e));

        // Hide after 6.5 seconds
        setTimeout(()=>{
            textEl.style.opacity = 0;
            showGasmaskFlash();
        }, 6500);

    }, 1000);
}


function showGasmaskFlash() {
    // Change background to pewpew
    document.body.style.background = "url('gunkid.png') center/cover no-repeat";

    const texts = ["JUST SHOOT!", "DONT THINK!"];
    let index = 0;
    textEl.textContent = texts[index];
    textEl.style.opacity = 1;

    flashInterval = setInterval(()=>{
        index = (index + 1) % texts.length;
        textEl.style.opacity = 0;
        setTimeout(()=>{
            textEl.textContent = texts[index];
            textEl.style.opacity = 1;
        }, 200);
    }, 600);

    
    const clickHandler = () => {
    clicked = true;
    clearInterval(flashInterval);

    // Stop heavy breathing
    whistle.pause();
    whistle.currentTime = 0;

    // Play shooting sound immediately, on click
    gasmaskSound.currentTime = 0;
    gasmaskSound.play().catch(e => console.log("Audio play failed:", e));

    // Cut to black instantly
    blackFade.style.transition = "none";
    blackFade.style.opacity = "1";

    // Go to next page after 5s
    setTimeout(()=>{
        window.location.href = "ohno.html";
    }, 5000);
    };

    
    document.body.addEventListener('click', clickHandler, {once:true});

    //dead
    setTimeout(()=>{
        if(!clicked){
            clearInterval(flashInterval);
            window.location.href = "deathgun.html";
        }
    }, 5000); // 5s to react
}
</script>

</body>
</html>